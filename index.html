
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>RoadAlert Upload</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <nav>
    <a href="index.html">Home</a>
    <a href="explore.html">Explore</a>
    <a href="user.html?userID=1">My Uploads</a> <!-- Replace 1 with dynamic or test userID -->
  </nav>  
  <h2>RoadAlert Upload</h2>
  <form id="uploadForm">
    <label for="file">Choose File (image or video):</label>
    <input type="file" id="file" name="File" required>

    <label for="fileName">File Name:</label>
    <input type="text" id="fileName" name="FileName" required>

    <label for="userID">User ID:</label>
    <input type="text" id="userID" name="userID" required>

    <label for="userName">User Name:</label>
    <input type="text" id="userName" name="userName" required>

    <button type="submit">Upload</button>
  </form>

  <p id="response"></p>

  <script>
    const form = document.getElementById('uploadForm');
    const response = document.getElementById('response');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(form);
      const endpoint = "https://prod-08.northcentralus.logic.azure.com:443/workflows/d324804e45064a91a2aea867f4ad9712/triggers/When_a_HTTP_request_is_received/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2FWhen_a_HTTP_request_is_received%2Frun&sv=1.0&sig=VnKo7U8gUkNfexwI9AknaxR_ie3OzvJUb9hwyGFmiUw";

      try {
        const res = await fetch(endpoint, {
          method: 'POST',
          body: formData
        });
        const data = await res.json();
        response.textContent = "Upload successful! Response ID: " + (data.id || "unknown");
      } catch (err) {
        response.textContent = "Error: " + err.message;
      }
    });
  </script>
  <script type="text/javascript">
    var appInsights = window.appInsights || function (config) {
      function r(config) { t[config] = function () { var i = arguments; t.queue.push(function () { t[config].apply(t, i) }) } }
      var t = { config: config }, u = document, e = window, o = "script", s = u.createElement(o), i, f;
      s.src = config.url || "https://az416426.vo.msecnd.net/scripts/a/ai.0.js";
      u.getElementsByTagName(o)[0].parentNode.appendChild(s);
      t.queue = [];
      for (i = ["Event", "Exception", "Metric", "PageView", "Trace", "Dependency"]; i.length;) r("track" + i.pop());
      r("setAuthenticatedUserContext");
      r("clearAuthenticatedUserContext");
      config.disableExceptionTracking || (i = "onerror", r("_" + i), f = e[i], e[i] = function (config, r, u, e, o) {
        var s = f && f(config, r, u, e, o);
        s !== !0 && t["_" + i](config, r, u, e, o);
        return s;
      });
      return t;
    }({
      instrumentationKey: "4c317b61-5741-4965-a81a-415ce50726fd"
    });
  
    window.appInsights = appInsights;
    appInsights.trackPageView();
  </script>
  
</body>
</html>
